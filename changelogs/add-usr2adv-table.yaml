databaseChangeLog:
  - changeSet:
      id: 7
      author: kacper
      changes:
        - createTable:
            tableName: usr2adv
            columns:
              - column:
                  name: id
                  type: INT
                  constraints:
                    primaryKey: true
                    nullable: false
                  comment: "ID, PK w tej tabeli, wrzucony index"
              - column:
                  name: usrid
                  type: INT
                  constraints:
                    nullable: false
                  comment: "ID usera, users.id, FK, wrzucony index"
              - column:
                  name: advgrpid
                  type: INT
                  constraints:
                    nullable: false
                  comment: "ID grupy, advgrp.id, FK, wrzucony index"
              - column:
                  name: status
                  type: char(1)
                  constraints:
                    nullable: false
                  comment: "Status grupy. Używany do określania i łatwiejszego wyszukiwania. Przykładowe statusy I - inactive, A - active, D - deleted"
              - column:
                  name: updstmp
                  type: date
                  constraints:
                    nullable: false
                  comment: "Data kiedy był zrobiony ostatni update na tym wierszu. Wrzucony trigger trg_update_updstmp_usr2adv"
              - column:
                  name: insstmp
                  type: date
                  constraints:
                    nullable: false
                  comment: "Data kiedy powstał wpis. Wrzucony trigger trg_insert_insstmp_usr2adv"
              - column:
                  name: addtxt1
                  type: varchar(35)
                  constraints:
                    nullable: true
                  comment: "Kolumna rozwojowa, obecnie pusta"
		- addForeignKeyConstraint:
            baseTableName: usr2adv
            baseColumnNames: usrid
            referencedTableName: users
            referencedColumnNames: id
            constraintName: fk_usr2adv_users
		- addForeignKeyConstraint:
            baseTableName: usr2adv
            baseColumnNames: usrid
            referencedTableName: advgrp
            referencedColumnNames: advgrpid
            constraintName: fk_usr2adv_advgrp

  - changeSet:
      id: 8
      author: kacper
      changes:
        - sql:
            comment: "Trigger aktualizujący kolumnę updstmp przy aktualizacji"
            sql: |
              CREATE OR REPLACE TRIGGER trg_update_updstmp_usr2adv
              BEFORE UPDATE ON usr2adv
              FOR EACH ROW
              EXECUTE FUNCTION update_updstmp();

  - changeSet:
      id: 9
      author: kacper
      changes:
        - sql:
            comment: "Trigger ustawiający kolumnę insstmp przy wstawieniu nowego wiersza"
            sql: |
              CREATE OR REPLACE TRIGGER trg_insert_insstmp_usr2adv
              BEFORE INSERT ON usr2adv
              FOR EACH ROW
              EXECUTE FUNCTION insert_insstmp();
			 
  - changeSet:
      id: 10
      author: kacper
      changes:
        - createIndex:
            indexName: usr2adv_k1
            tableName: usr2adv
            unique: true
            columns:
              - column:
                  name: id

  - changeSet:
      id: 11
      author: kacper
      changes:
        - createIndex:
            indexName: usr2adv_k2
            tableName: usr2adv
            columns:
              - column:
                  name: usrid
				  
  - changeSet:
      id: 12
      author: kacper
      changes:
        - createIndex:
            indexName: usr2adv_k3
            tableName: usr2adv
            columns:
              - column:
                  name: advgrpid